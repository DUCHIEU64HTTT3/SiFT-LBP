<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>K·∫øt qu·∫£ t√¨m ki·∫øm ·∫£nh t∆∞∆°ng t·ª±</title>

<style>
:root{
    --primary:#2563eb;
    --accent:#38bdf8;
    --bg:#f1f5f9;
    --card:#ffffff;
    --text:#0f172a;
    --muted:#64748b;
    --border:#e2e8f0;
}

*{ box-sizing:border-box; }

body{
    margin:0;
    padding:26px 14px;
    font-family:"Inter","Segoe UI",sans-serif;
    background:linear-gradient(135deg,#eef2ff,#f8fafc);
    color:var(--text);
}

/* ===== CONTAINER ===== */
.container{
    max-width:1150px;
    margin:auto;
    background:var(--card);
    padding:30px;
    border-radius:26px;
    box-shadow:0 30px 60px rgba(15,23,42,0.14);
}

/* ===== HEADER ===== */
.header{
    display:flex;
    justify-content:center;
    align-items:center;
    gap:14px;
    margin-bottom:12px;
}
.logo{
    width:52px;
    height:52px;
    border-radius:16px;
    background:linear-gradient(135deg,var(--primary),var(--accent));
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:24px;
    color:#fff;
}
.header h1{
    margin:0;
    font-size:24px;
}
.header p{
    margin:2px 0 0;
    font-size:13px;
    color:var(--muted);
}

/* ===== QUERY CARD ===== */
.query-card{
    width:fit-content;
    margin:18px auto 30px;
    background:#fff;
    padding:16px 16px 20px;
    border-radius:22px;
    box-shadow:0 16px 40px rgba(0,0,0,0.18);
    text-align:center;
}
.query-title{
    font-size:18px;
    font-weight:700;
    color:var(--primary);
    margin-bottom:12px;
}
.query-card img{
    max-width:260px;
    border-radius:16px;
    border:1px solid var(--border);
}

/* ===== TITLES ===== */
.section-title{
    text-align:center;
    font-size:20px;
    font-weight:700;
    color:var(--primary);
    margin:34px 0 14px;
}

/* ===== DIVIDER ===== */
.divider{
    height:1px;
    background:linear-gradient(to right,transparent,#e5e7eb,transparent);
    margin:34px 0;
}

/* ===== RESULTS GRID ===== */
.results-grid{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(210px,1fr));
    gap:20px;
}

.result-item{
    background:#fff;
    border-radius:18px;
    padding:12px;
    position:relative;
    box-shadow:0 10px 28px rgba(0,0,0,0.12);
    transition:0.3s;
}
.result-item:hover{
    transform:translateY(-6px);
    box-shadow:0 18px 40px rgba(0,0,0,0.2);
}

.rank-badge{
    position:absolute;
    top:10px;
    left:10px;
    background:linear-gradient(135deg,var(--primary),var(--accent));
    color:#fff;
    font-size:13px;
    font-weight:700;
    padding:3px 10px;
    border-radius:999px;
}

.result-item img{
    width:100%;
    height:160px;
    object-fit:cover;
    border-radius:14px;
    border:1px solid var(--border);
    margin-bottom:10px;
}

.label{
    font-weight:700;
    font-size:15px;
    color:var(--primary);
}
.distance{
    font-size:13px;
    color:var(--muted);
}

/* ===== FEATURE STACK (VERTICAL) ===== */
.feature-stack{
    display:flex;
    flex-direction:column;
    gap:26px;
    align-items:center;
}

/* FEATURE CARD */
.feature-card{
    width:100%;
    max-width:900px;
    background:#f8fafc;
    border-radius:22px;
    padding:18px;
    border:1px solid var(--border);
    box-shadow:0 10px 25px rgba(0,0,0,0.12);
}

.feature-card h4{
    text-align:center;
    margin-bottom:14px;
    color:#334155;
}

/* IMAGE */
.feature-img{
    width:100%;
    border-radius:16px;
    border:1px solid var(--border);
    box-shadow:0 8px 20px rgba(0,0,0,0.15);
    margin-bottom:14px;
    object-fit:contain;
}

/* SIFT SCROLL */
.sift-scroll{
    max-height:520px;
    overflow-y:auto;
}

/* ===== BACK ===== */
.back-btn{
    display:flex;
    align-items:center;
    justify-content:center;
    gap:8px;
    width:fit-content;
    margin:42px auto 0;
    padding:13px 28px;
    background:linear-gradient(135deg,var(--primary),var(--accent));
    color:#fff;
    border-radius:14px;
    text-decoration:none;
    font-weight:600;
    transition:0.3s;
}
.back-btn:hover{
    transform:translateY(-1px);
    box-shadow:0 12px 30px rgba(37,99,235,0.45);
}

/* ===== RESPONSIVE ===== */
@media(max-width:720px){
    .query-card img{ max-width:200px; }
    .result-item img{ height:140px; }
}
</style>
</head>

<body>
<div class="container">

    <!-- HEADER -->
    <div class="header">
        <div class="logo">üîç</div>
        <div>
            <h1>K·∫øt qu·∫£ t√¨m ki·∫øm</h1>
            <p>Image Similarity Search ‚Äì LBP ‚Ä¢ SIFT</p>
        </div>
    </div>

    <!-- QUERY -->
    <div class="query-card">
        <div class="query-title">·∫¢nh truy v·∫•n</div>
        <img src="{{ url_for('uploaded_file', filename=query) }}">
    </div>

    <!-- RESULTS -->
    <div class="section-title">Top 5 ·∫£nh t∆∞∆°ng t·ª±</div>
    <div class="results-grid">
    {% for fname, label, dist in results %}
        <div class="result-item">
            <div class="rank-badge">#{{ loop.index }}</div>
            <img src="{{ url_for('dataset_image', filename=fname) }}">
            <div class="label">{{ label }}</div>
            <div class="distance">Distance: {{ "%.4f"|format(dist) }}</div>
        </div>
    {% endfor %}
    </div>

    <div class="divider"></div>

    <!-- FEATURE -->
    {% if method == 'both' %}
        <div class="section-title">K·∫øt h·ª£p LBP & SIFT</div>

        <div class="feature-stack">

            <!-- LBP -->
            <div class="feature-card">
                <h4>LBP Histogram</h4>
                <img class="feature-img"
                     src="{{ url_for('static', filename='lbp_hist/' + lbp_img) }}">
            </div>

            <!-- SIFT -->
            <div class="feature-card sift-scroll">
                <h4>SIFT Matching</h4>
                {% for img_name in match_imgs %}
                    <img class="feature-img"
                         src="{{ url_for('static', filename='sift_match/' + img_name) }}">
                {% endfor %}
            </div>

        </div>
    {% endif %}

    <!-- BACK -->
    <a href="{{ url_for('index') }}" class="back-btn">
        ‚¨Ö Quay l·∫°i t√¨m ki·∫øm
    </a>

</div>
</body>
</html>
